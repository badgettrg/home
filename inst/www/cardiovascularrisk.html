<!DOCTYPE html>
<html lang="en">
<head>
<title>openRules</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<!-- jquery -->
<script src="//code.jquery.com/jquery-2.1.3.min.js"> </script>

<!-- ocpu library -->
<script src="opencpu/opencpu.js"> </script>

<!-- tooltip -->
<script type="text/javascript" src="qtip/jquery.qtip.min.js"></script>
<link rel="stylesheet" type="text/css" href="qtip/jquery.qtip.min.css" />

<!-- some optional styling stuff -->
<script src="bootstrap/js/bootstrap.js"></script>
<script src="jqueryui/jquery-ui-1.10.3.custom.js"></script>

<script>
    //init this script when the page has loaded
    $(document).ready(function(){
      $("#submitbutton").on("click", function(){
        //disable the button to prevent multiple clicks
        $("#submitbutton").attr("disabled", "disabled");
        
        //read the values
        var age0 = $("#age").val() * 1;
		var gender = 'f'
		if ($("#gender1").prop("checked") == true){gender = 'm'}
		var ethnicity = 'h'
		if ($("#ethnicity0").prop("checked") == true){ethnicity = 'b'}
		if ($("#ethnicity1").prop("checked") == true){ethnicity = 'w'}
		if ($("#ethnicity2").prop("checked") == true){ethnicity = 'a'}
		if ($("#ethnicity3").prop("checked") == true){ethnicity = 'h'}
		var smoke0 = 0
		if ($("#smoker1").prop("checked") == true){smoke0 = 1}
		var diabetes0 = 0
		if ($("#diabetes1").prop("checked") == true){diabetes0 = 1}
		var bprx = 0
		if ($("#bprx1").prop("checked") == true){bprx = 1}
        var sbp = $("#sbp").val() * 1;
        var tchol0 = $("#tchol").val() * 1;
        var hdl0 = $("#hdl").val() * 1;
	  
        //perform the request
        var req = opencpu.r_fun_json("cardiovascularrisk", {
        age0 : age0,
        gender : gender,
        ethnicity : ethnicity,
        smoke0 : smoke0,
		diabetes0 : diabetes0,
		bprx : bprx,
		sbp : sbp,
		tchol0 : tchol0,
		hdl0 : hdl0
	  }, function(output){
          document.getElementById("output").innerHTML = output.message
        });
        
        //if R returns an error, alert the error message
        req.fail(function(){
          alert("Server error: " + req.responseText);
        });
        
        //after request complete, re-enable the button 
        req.always(function(){
          $("#submitbutton").removeAttr("disabled")
        });
      });

	//http://qtip2.com/
	// Apply tooltip on all <a/> elements with title attributes. Mousing over
    // these elements will the show tooltip as expected, but mousing onto the
    // tooltip is now possible for interaction with it's contents.
    //$('a').each(function () {
    $('.hastip').each(function () {
        $(this).qtip({
            content: $(this).next('.tooltiptext'),
            hide: {
                fixed: true,
                delay: 300
            },
			position: {
				my: 'bottom left',  // Position my top left...
				at: 'bottom right', // at the bottom right of...
			},
			style: { classes: 'ToolTipClass'
			}
		});
    });

	$('.hastip').click(function(e) {
		e.stopPropagation();
		return false;
	});	
      //this is only needed when using CORS (i.e. web pages hosted outside opencpu)
      if(!location.pathname.match("^/ocpu/.*/appdemo/www")){
        opencpu.seturl("//public.opencpu.org/ocpu/library/appdemo/R");
      }
    });
    </script>
    
    <style>
      #output{
       /*  height: 40px;
        width: 400px;
        border: 1px solid gray;
        padding: 3px; */
      }

	  .tooltiptext{
			display: none;
		}
	  .ToolTipClass{
		color:black;
		border-color:#0022B4;
		background-color: #6DC6E7
		}
    </style>

</head>

<body>
<!-- 
http://jquery-csv.googlecode.com/git/examples/basic-usage.html
http://jquery-csv.googlecode.com/git/examples/flot.html -> seems best and most stable without reticulating spines error
http://code.google.com/p/jquery-csv/wiki/API -> instructions
-->
<div class="container" style="width:1000px;">

    <div class="page-header" style="color:#0022B4">
			<h1>openRules</h1>
			<h2>What is my chance of heart or blood vessel disease over the next 10 years?</h2>
			<div id="">This page uses the Pooled Cohort ASCVD Risk Equations and does not apply to people with known atherosclerositic cardiovascular disease or LDL-C <u>></u> 190 mg/dl as these people need high-intensity statins.</div>

			<div style="float:left;color:#0022B4">
	
        <form id="paramform" target="target" style="width:400px;">
          <fieldset style="border: 3px solid #6DC6E7; background-color: #FFFFFF;width:400px;height:400px;">
		  <legend>Enter values:</legend>

	    <div style="display:block">Age: <input type="number" min="15" max="100" id="age"></div>
             
		<div style="display:block"><label>Gender:</label><br/>
		<input type="radio" name="gender" id="gender1" value="m"><label for="gender1">Male</label><br/>
		<input type="radio" name="gender" id="gender0" value="f"><label for="gender0">Female</label>
		</div> 
		<div style="display:block"><label>Ethnicity:</label><br/>
		<input type="radio" name="ethnicity" id="ethnicity0" value="b"><label for="ethnicity0">African-American</label>
		<input type="radio" name="ethnicity" id="ethnicity1" value="w"><label for="ethnicity1">Anglo</label><br/>
		<input type="radio" name="ethnicity" id="ethnicity2" value="a"><label for="ethnicity2">Asian</label>
		<input type="radio" name="ethnicity" id="ethnicity3" value="h"><label for="ethnicity3">Hispanic</label>
		</div> 
		<div style="display:block"><a href="#" class="hastip">Smoker:</a>
<div class="tooltiptext">
Is this for former smokers or just current smokers?
		<ul>
			<li>Suggestion: include current smokers and those who quit <= three years ago.</li>
			<li>Rationale:
			<ul>
				<li>The <a href="http://www.cardiosource.org/science-and-quality/practice-guidelines-and-quality-standards/2013-prevention-guideline-tools.aspx">2013 ACC/AHA website</a> does not clarify current versus ever smoking. The source document states "current smoker" in its equations.(1)</li>
				<li>However, the risk of cardiac events after smoking cessation may return to normal after three years.(4)</li>
			</ul></li>
		</ul>
This note added 4/5/2014.
</div>
		
		<br/>
		<input type="radio" name="smoker" id="smoker0" value="0"><label for="smoker0">No</label>
		<input type="radio" name="smoker" id="smoker1" value="1"><label for="smoker1">Yes</label><br/>
		</div> 
		<div style="display:block"><label>Diabetes:</label><br/>
		<input type="radio" name="diabetes" id="diabetes0" value="0"><label for="diabetes0">No</label>
		<input type="radio" name="diabetes" id="diabetes1" value="1"><label for="diabetes1">Yes</label><br/>
		</div> 
		<div style="display:block"><label>Medication for hypertension:</label><br/>
		<input type="radio" name="bprx" id="bprx0" value="0"><label for="bprx0">No</label>
		<input type="radio" name="bprx" id="bprx1" value="1"><label for="bprx1">Yes</label><br/>
		</div> 
	    <div style="display:block">Systolic blood pressure: <input type="number" min="50" max="250" id="sbp"></div>
	    <div style="display:block">Total cholesterol: <input type="number" min="50" max="500" id="tchol"></div>
	    <div style="display:block">HDL cholesterol: <input type="number" min="1" max="150" id="hdl"></div>
			
		<button id="submitbutton" type="button">Submit (answer will show to the right)</button>
          </fieldset>
        </form>
	</div>
     <div id="output" style="width:550px;float:right">
	 </div>
	<div style="clear:both"></div>
    </div>

	<h3>References</h3>
	  <ol>
	  <li>Goff DC Jr, Lloyd-Jones DM, Bennett G, Coady S, D'Agostino RB Sr, Gibbons R, Greenland P, Lackland DT, Levy D, O'Donnell CJ, Robinson J, Schwartz JS, Shero ST, Smith SC Jr, Sorlie P, Stone NJ, Wilson PW. 2013 ACC/AHA Guideline on the Assessment of Cardiovascular Risk: A Report of the American College of Cardiology/American Heart Association Task Force on Practice Guidelines. Circulation. 2013. PMID: <a href="http://pubmed.gov/24222018">24222018</a>.</li>
	  <li>Martin SS, Blaha MJ, Elshazly MB, Toth PP, Kwiterovich PO, Blumenthal RS, Jones SR. Comparison of a novel method vs the Friedewald equation for estimating  low-density lipoprotein cholesterol levels from the standard lipid profile. JAMA. 2013 Nov 20;310(19):2061-8. doi: <a href="http://dx.doi.org/10.1001/jama.2013.280532">10.1001/jama.2013.280532</a>. PMID: <a href="http://pubmed.gov/24240933">24240933</a>.</li>
	  <li>Taylor F, Huffman MD, Macedo AF, Moore TH, Burke M, Davey Smith G, Ward K, Ebrahim S. Statins for the primary prevention of cardiovascular disease. Cochrane Database Syst Rev. 2013. PMID: <a href="http://pubmed.gov/23440795">23440795</a>.</li>
	  <li>Rea TD, Heckbert SR, Kaplan RC, Smith NL, Lemaitre RN, Psaty BM. Smoking status and risk for recurrent coronary events after myocardial infarction. Ann Intern Med. 2002 Sep 17;137(6):494-500. PMID: <a href="http://pubmed.gov/12230350">12230350</a>.</li>
	  <li>Estruch R, Ros E, Salas-Salvadó J, Covas MI, Corella D, Arós F,  et al. PREDIMED Study Investigators. Primary prevention of cardiovascular disease with a Mediterranean diet. N Engl J Med. 2013 Apr 4;368(14):1279-90. doi: 10.1056/NEJMoa1200303. PMID: <a href="http://pubmed.gov/23432189">23432189</a> <br/>
	  <a href="#" class="hastip">(Details about the Mediterranean Diet)</a>.
	  <div class="tooltiptext">
The version of this diet in this trial reduced major cardiovascular events. This version encouraged daily either 
		<ul>
			<li>1/4 cup (4 tablespoons) of extra virgin olive oil</li>
			<li>30 grams of mixed nuts per day (15 g of walnuts, 7.5 g of hazelnuts, and 7.5 g of almonds). The nuts possibly conferred less benefit than the olive oil.</li>
		</ul>
<a href="http://dietamediterranea.com/en/piramide/">Another version</a> that encourages two servings of vegetables at every meal is available.
</div>
	  
	  </li>
	<li>Barry MJ, Edgman-Levitan S. Shared decision making--pinnacle of patient-centered care. N Engl J Med. 2012 Mar 1;366(9):780-1. doi: <a href="http://pubmed.gov/10.1056/NEJMp1109283">10.1056/NEJMp1109283</a>. PMID: <a href="http://pubmed.gov/22375967">22375967</a></li>
	  </ol>
    <div class="row">
      <div class="span12">

	  	  <h3>About</h3>
	        <ul>
			<li><a href="https://github.com/openRules">Source code at GitHub</a></li>
			<li><a href="../man/cardiovascularrisk/html">Manual</a></li>
			<li>Contribute: <a href="https://github.com/openRules/home/issues?q=team%3AopenRules%2FCardiovascular-risk ">open issues</a></li>
			<li><a href="https://github.com/orgs/openRules/teams/cardiovascular-risk">Authors</a></li>
			<li>These pages may not function on some versions of Internet Explorer.</li>
		</ul>
		
		</div>
		</div>
  </div>
</body>
</html>
